---
import Layout from '../layouts/Layout.astro';
---

<Layout>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js" is:inline></script>
  <main class="auth">
    <h1>Acceso</h1>
    <p>Inicia sesión o recupera la contraseña.</p>
    <div class="actions">
      <button id="login">Login</button>
      <button id="recovery">Recuperar contraseña</button>
    </div>
  </main>

  <script is:inline>
    (function() {
      function initIdentity() {
        if (!window.netlifyIdentity) {
          setTimeout(initIdentity, 50);
          return;
        }

        window.netlifyIdentity.on('init', function(user) {
          if (user) {
            window.location.href = '/admin/';
          }
        });

        window.netlifyIdentity.on('login', function(user) {
          window.location.href = '/admin/';
        });

        document.getElementById('login').addEventListener('click', function() {
          window.netlifyIdentity.open('login');
        });

        document.getElementById('recovery').addEventListener('click', function() {
          window.netlifyIdentity.open('recovery');
        });

        window.netlifyIdentity.init();
      }

      initIdentity();
    })();
  </script>

  <style>
    .auth {
      max-width: 520px;
      margin: 4rem auto;
      padding: 2rem;
      text-align: center;
    }
    .actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
    }
    button {
      border: 0;
      padding: 0.75rem 1.25rem;
      border-radius: 999px;
      cursor: pointer;
      background: #111;
      color: #fff;
    }
  </style>
</Layout>
